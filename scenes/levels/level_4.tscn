[gd_scene load_steps=19 format=3 uid="uid://dxiqoa00bnrk2"]

[ext_resource type="PackedScene" uid="uid://be3c7t3180orp" path="res://scenes/map_units/grounds/basic_ground.tscn" id="1_06474"]
[ext_resource type="Script" uid="uid://dsjdg8fqcsonj" path="res://scripts/levels/level_4_manager.gd" id="1_w6h2s"]
[ext_resource type="PackedScene" uid="uid://lcy1suf8pwf7" path="res://scenes/levels/level_10087-1.tscn" id="2_hsvsk"]
[ext_resource type="PackedScene" uid="uid://p6dopje3btqk" path="res://scenes/characters/player/Pipe_player.tscn" id="3_ogj6a"]
[ext_resource type="Script" uid="uid://bvx6bpkegqfs7" path="res://scripts/map_units/trail_system.gd" id="4_ogj6a"]
[ext_resource type="Texture2D" uid="uid://ufso8s6ib6or" path="res://assets/sprites/map_units/mirror_frame.png" id="5_anwe6"]
[ext_resource type="Script" uid="uid://h5cnwha2fxsl" path="res://scripts/map_units/door_system.gd" id="5_ts8eg"]
[ext_resource type="Script" uid="uid://ccvwii8dy8t0d" path="res://src/test/checker.gd" id="6_rej77"]
[ext_resource type="PackedScene" uid="uid://hg7ttp1018uk" path="res://scenes/map_units/pressure_plate.tscn" id="7_5vn0v"]
[ext_resource type="PackedScene" uid="uid://ct5l5eh65tbi1" path="res://scenes/map_units/flag.tscn" id="9_glw47"]
[ext_resource type="AudioStream" uid="uid://bwmdx6xidigrr" path="res://assets/sounds/sfx/pressbutton.mp3" id="9_qvnao"]
[ext_resource type="PackedScene" uid="uid://bobd1dnm65ixa" path="res://scenes/characters/npc/zhang.tscn" id="10_4wsov"]
[ext_resource type="AudioStream" uid="uid://brvd0hkyfp7ly" path="res://assets/sounds/sfx/loosebutton.mp3" id="10_hsvsk"]
[ext_resource type="PackedScene" uid="uid://cs3qu0yak2v7l" path="res://scenes/map_units/start_cutscenes.tscn" id="13_fcb7b"]
[ext_resource type="PackedScene" uid="uid://5s2ku8p8nqju" path="res://scenes/map_units/camera.tscn" id="15_ov8fk"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_anwe6"]
size = Vector2(79, 473)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_5vn0v"]
size = Vector2(300, 47)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ts8eg"]
size = Vector2(301, 25)

[node name="Level4" type="Node2D" node_paths=PackedStringArray("player", "static_items", "flag")]
script = ExtResource("1_w6h2s")
player = NodePath("Steel_Pipe")
next_scene = ExtResource("2_hsvsk")
static_items = [NodePath("DoorSystem")]
flag = NodePath("Flag")
timeline_name = "level_4"

[node name="BasicGround" parent="." instance=ExtResource("1_06474")]
position = Vector2(-7, 2)

[node name="Steel_Pipe" parent="." instance=ExtResource("3_ogj6a")]
position = Vector2(105, -33)
frame = 1

[node name="TrailSystem" type="Node2D" parent="."]
script = ExtResource("4_ogj6a")

[node name="Timer" type="Timer" parent="TrailSystem"]
wait_time = 0.1
autostart = true

[node name="DoorSystem" type="Node2D" parent="."]
script = ExtResource("5_ts8eg")

[node name="Door" type="StaticBody2D" parent="DoorSystem"]
position = Vector2(-8, 0)
collision_layer = 2
collision_mask = 0

[node name="Sprite2D" type="Sprite2D" parent="DoorSystem/Door"]
position = Vector2(581.5, 159.5)
scale = Vector2(4.937499, 29.312502)
texture = ExtResource("5_anwe6")

[node name="CollisionShape2D" type="CollisionShape2D" parent="DoorSystem/Door"]
position = Vector2(581.5, 157.5)
shape = SubResource("RectangleShape2D_anwe6")

[node name="pressure_plate" parent="DoorSystem" instance=ExtResource("7_5vn0v")]
position = Vector2(368, 129)
press_sfx = ExtResource("9_qvnao")
loose_sfx = ExtResource("10_hsvsk")

[node name="Platform" type="StaticBody2D" parent="DoorSystem"]
position = Vector2(2, 55)

[node name="Sprite2D" type="Sprite2D" parent="DoorSystem/Platform"]
position = Vector2(393.50003, 105.00001)
scale = Vector2(18.6875, 2.9999998)
texture = ExtResource("5_anwe6")

[node name="CollisionShape2D" type="CollisionShape2D" parent="DoorSystem/Platform"]
position = Vector2(393, 104.5)
shape = SubResource("RectangleShape2D_5vn0v")

[node name="Checker" type="Area2D" parent="DoorSystem/Platform"]
light_mask = 0
position = Vector2(374, 86)
script = ExtResource("6_rej77")

[node name="CollisionShape2D" type="CollisionShape2D" parent="DoorSystem/Platform/Checker"]
position = Vector2(19.5, 0.5)
shape = SubResource("RectangleShape2D_ts8eg")

[node name="Flag" parent="." instance=ExtResource("9_glw47")]
position = Vector2(1071, 353)

[node name="start_cutscenes" parent="." instance=ExtResource("13_fcb7b")]

[node name="Zhang" parent="." node_paths=PackedStringArray("level_manager", "player") instance=ExtResource("10_4wsov")]
position = Vector2(49, -4)
level_manager = NodePath("..")
player = NodePath("../Steel_Pipe")

[node name="camera" parent="." instance=ExtResource("15_ov8fk")]
aberration = 0.01

[connection signal="timeout" from="TrailSystem/Timer" to="TrailSystem" method="_on_timer_timeout"]
[connection signal="body_entered" from="DoorSystem/Platform/Checker" to="DoorSystem/Platform/Checker" method="_on_body_entered"]
[connection signal="body_exited" from="DoorSystem/Platform/Checker" to="DoorSystem/Platform/Checker" method="_on_body_exited"]
